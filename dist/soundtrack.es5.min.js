require=function e$$0(f,e,g){function k(a,b){if(!e[a]){if(!f[a]){var c="function"==typeof require&&require;if(!b&&c)return c(a,!0);if(h)return h(a,!0);c=Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c;}c=e[a]={exports:{}};f[a][0].call(c.exports,function(b){var c=f[a][1][b];return k(c?c:b)},c,c.exports,e$$0,f,e,g)}return e[a].exports}for(var h="function"==typeof require&&require,b=0;b<g.length;b++)k(g[b]);return k}({soundtrack:[function(m,f,e){function g(b){switch("undefined"===
typeof b?"undefined":h(b)){case "object":if(!b.name&&!b.src)throw"every track must have a name or a src: "+JSON.stringify(b);var a=b.name,l=b.src,c=b.start_ofs,d=b.end_ofs,e=b.loop_ofs,f=b.loop;return{name:void 0===a?b.src:a,src:void 0===l?b.name+".mp3":l,start_ofs:void 0===c?0:c,end_ofs:void 0===d?0:d,loop_ofs:void 0===e?b.start_ofs||0:e,loop:void 0===f?!0:f};case "string":return g({name:b})}}Object.defineProperty(e,"__esModule",{value:!0});var k=function(){function b(a,b){for(var c=0;c<b.length;c++){var d=
b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(a,l,c){l&&b(a.prototype,l);c&&b(a,c);return a}}(),h="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"===typeof Symbol&&b.constructor===Symbol?"symbol":typeof b};m=function(){function b(a){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this.players=[];this.tracks=
[];this.tracksByName={};this.ready=this.playing=!1;a=a||{};this.loadtracks(a.tracks);if(void 0!==a.autoplay&&!1!==a.autoplay)switch(this.playing=!0,h(a.autoplay)){case "number":case "string":this.play(a.autoplay);break;case "boolean":this.play(0)}}k(b,[{key:"playByTrack",value:function(a){this.add_player(this.tracks[a])}},{key:"playByName",value:function(a){console.log("todo should play "+a+" by name: "+this.tracks[this.tracksByName[a]])}},{key:"play",value:function(a){switch("undefined"===typeof a?
"undefined":h(a)){case "number":this.playByTrack(a);break;case "string":this.playByName(a)}}},{key:"loadtracks",value:function(a){var b=this;this.tracks=this.tracks.concat(a.map(g)||[]);this.tracks.map(function(a,d){a.name&&(b.tracksByName[a.name]=d)})}},{key:"add_player",value:function(a){var b=this,c=new Audio(a.src),d=void 0,e=!1;c.autoplay=!1;c.currentTime=a.start_ofs/1E3;var f=a.end_ofs;c.oncanplaythrough=function(){b.ready=!0};window.setInterval(function(){var g=1E3*c.duration-f;b.ready&&b.playing&&
(!e||performance.now()-d>g)&&(e&&(c.currentTime=a.loop_ofs),e=!0,d=performance.now(),c.play())},1);return this.players.push(c)-1}}]);return b}();e.soundtrack=m},{}]},{},[]);
